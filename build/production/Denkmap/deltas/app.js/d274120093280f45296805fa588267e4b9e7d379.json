["/*58abb07327754a71ec02623ca2e7bdd00731605a",42,50167,"M=[],K,N,J;for(K=0,N=m.length;K<N;K++){J=m[K];M",50256,36,"M",50293,405569,"navigation.Bar\",{extend:Ext.TitleBar",308959,120,"defaultType:\"button\",layout:{type:\"hbox\"},defaultBackButtonText:\"Back\",animation:{duration:300},useTitleForBackButtonText:null,view:null,android2Transforms:false,backButton:{align:\"left\",ui:\"back\",hidden:true}",458035,40,"animation:false}]",290160,36,"!a.items){a.items=[]}this.backButtonStack=[];this.activeAnimations=[];this.callParent([a])},applyBackButton",287760,38,"Button,this.getBackButton())},updateBackButton:function(a,b){if(b){this.remove(b)}if(a){this.add(a);a.on({scope:this,tap:this.onBackButtonTap})}},onBackButtonTap:function(){this.fireEvent(\"back\",this)},updateView:function(b){var d=this,j=d.getBackButton(),a,c,f,g,e,h;d.getItems();if(b){a=b.getInnerItems();for(c=0;c<a.length;c++){g=a[c];e=(g.getTitle)?g.getTitle():g.config.title;d.backButtonStack.push(e||\"&nbsp;\")}h=d.getTitleText();if(h===undefined){h=\"\"}d.setTitle(h);f=d.getBackButtonText();if(f){j.setText(f);j.show()}}},onViewAdd:function(c,e){var d=this,b=d.backButtonStack,a,f;d.endAnimation();f=(e.getTitle)?e.getTitle():e.config.title;b.push(f||\"&nbsp;\");a=b.length>1;d.doChangeView(c,a,false)},onViewRemove:function(c){var d=this,b=d.backButtonStack,a;d.endAnimation();b.pop();a=b.length>1;d.doChangeView(c,a,true)},doChangeView:function(k,c,g){var r=this,o=r.leftBox,e=o.element,f=r.titleComponent,m=f.element,n=r.getBackButton(),l=r.getTitleText(),h=r.getBackButtonText(),q=r.getAnimation()&&k.getLayout().getAnimation(),p=q&&q.isAnimation&&k.isPainted(),d,i,a,j,b;if(p){i=r.createProxy(o.element);e.setStyle(\"opacity\",\"0\");n.setText(h);n[c?\"show\":\"hide\"]();a=r.createProxy(f.element.getParent());m.setStyle(\"opacity\",\"0\");r.setTitle(l);d=r.measureView(i,a,g);j=d.left;b=d.title;r.isAnimating=true;r.animate(e,j.element);r.animate(m,b.element,function(){m.setLeft(d.titleLeft);r.isAnimating=false;r.refreshTitlePosition()}",251317,32,"2&&!this.getAndroid2Transforms()){i.ghost.destroy();a.ghost.destroy()}else{r.animate(i.ghost,j.ghost);r.animate(a.ghost,b.ghost,function(){i.ghost.destroy();a.ghost.destroy()})}}else{if(c){n.setText(h);n.show()}else{n.hide()}r.setTitle(l)}},measureView:function(e,u,k){var w=this,j=w.element,v=w.leftBox.element,p=w.titleComponent.element,l=Math.min(j.getWidth()/3,200),q=v.getWidth(),c=j.getX(),m=j.getWidth(),n=p.getX(),d=p.getLeft(),s=p.getWidth(),r=e.x,t=e.width,a=e.left,h=Ext.browser.is.AndroidStock2&&!this.getAndroid2Transforms(),i,b,f,x,o,g;g=c-r-t;if(k){i=g;b=Math.min(n-t,l)}else{b=g;i=Math.min(n-c,l)}if(h){f={element:{from:{left:i,opacity:1},to:{left:0,opacity:1}}}}else{f={element:{from:{transform:{translateX:i},opacity:0},to:{transform:{translateX:0},opacity:1}},ghost:{to:{transform:{translateX:b},opacity:0}}}}g=c-n+q;if((a+s)>n){o=c-n-s}if(k){p.setLeft(0);b=c+m-n-s;if(o!==undefined){i=o}else{i=g}}else{i=c+m-n-s;if(o!==undefined){b=o}else{b=g}i=Math.max(d,i)}if(h){x={element:{from:{left:i,opacity:1},to:{left:d,opacity:1}}}}else{x={element:{from:{transform:{translateX:i},opacity:0},to:{transform:{translateX:d},opacity:1}},ghost:{to:{transform:{translateX:b},opacity:0}}}}return{left:f,title:x,titleLeft:d}},animate:function(b,a,e){var c=this,d;b.setLeft(0);a=Ext.apply(a,{element:b,easing:\"ease-in-out\",duration:c.getAnimation().duration||250,preserveEndState:true});d=new Ext.fx.Animation(a);d",473273,33,"e){e.call(c)}},c);Ext.Animator.run(d);c.activeAnimations.push(d)},endAnimation:function(){var a=this.activeAnimations,d,b,c;if(a){c=a.length;for(b=0;b<c;b++){d=a[b];if(d.isAnimating){d.stopAnimation()}else{d.destroy()}}this.activeAnimations=[]}",311024,37,"!this.isAnimating){this.callParent()}},getBackButtonText:function(){var b=this.backButtonStack[this.backButtonStack.length-2],a=this.getUseTitleForBackButtonText();if(!a){if(b){b=this.getDefaultBackButtonText()}}return b},getTitleText:function(){return this.backButtonStack[this.backButtonStack.length-1]},beforePop:function(b){b--;for(var a=0;a<b;a++){this.backButtonStack.pop()}},doSetHidden:function(a){if(!a){this.element.setStyle({position:\"relative\",top:\"auto\",left:\"auto\",width:\"auto\"})}else{this.element.setStyle({position:\"absolute\",top:\"-1000px\",left:\"-1000px\",width:this.element.getWidth()+\"px\"})}},createProxy:function(b){var e,a,f,d,c;e=b.dom.cloneNode(true);e.id=b.id+\"-proxy\";b.getParent().dom.appendChild(e);e=Ext.get(e);a=b.getX();f=b.getY();d=b.getLeft();c=b.getWidth();e.setStyle(\"position\",\"absolute\");e.setX(a);e.setY(f);e.setHeight(b.getHeight());e.setWidth(c);return{x:a,y:f,left:d,width:c,ghost:e}}});Ext.define(\"Ext.navigation.View",264309,48,"NavigationView\",xtype:\"navigationview",456656,37,"navigationview\",navigationBar:{docked:\"top\"},defaultBackButtonText:\"Back\",useTitleForBackButtonText:false",457728,32,"duration:300,easing:\"ease-out\",type:\"slide\",direction:\"left\"}}",458035,40,"navigationBar:{splitNavigation:true}}],initialize:function(){var b=this,a=b.getNavigationBar();if(a){a.on({back:b.onBackButtonTap,scope:b});b.relayEvents(a,\"rightbuttontap\");b.relayEvents(b,{add:\"push\",remove:\"pop\"})}},applyLayout:function(a){a=a||{};return a},onBackButtonTap:function(){this.pop();this.fireEvent(\"back\",this)},push:function(a){return this.add(a)},pop:function(a){if(this.beforePop(a)){return this.doPop()}},beforePop:function(f){var e=this,g=e.getInnerItems();",249898,37,"var d=g.length-1,a;for(a=d;a>=0;a--){if((Ext.isString(f)&&Ext.ComponentQuery.is(g[a],f))||(Ext.isObject(f)&&f==g[a])){f=d-a;break}}if(!Ext.isNumber(f)){return false}}var c=g.length,b;if(!Ext.isNumber(f)||f<1){f=1}f=Math.min(f,c-1);if(f){e.getNavigationBar().beforePop(f);b=g.splice(-f,f-1);for(a=0;a<b.length;a++){this.remove(b[a])}return true}return false},doPop:function(){var b=this,c=this.getInnerItems();b.remove(c[c.length-1]);if(c.length<3&&this.$backButton){this.$backButton.hide()}if(this.$titleContainer){var a=c[c.length-2];this.$titleContainer.setTitle((a.getTitle)?a.getTitle():a.config.title)}return this.getActiveItem()},getPreviousItem:function(){var a=this.getInnerItems();return a[a.length-2]},updateUseTitleForBackButtonText:function(b){var a=this.getNavigationBar();if(a){a.setUseTitleForBackButtonText(b)}},updateDefaultBackButtonText:function(b){var a=this.getNavigationBar();if(a){a.setDefaultBackButtonText(b)}},applyNavigationBar:function(a){if(!a){a={hidden:true,docked:\"top\"}}if(a.title){delete a.title}a.view=this;a.useTitleForBackButtonText=this.getUseTitleForBackButtonText();if(a.splitNavigation){this.$titleContainer=this.add({docked:\"top\",xtype:\"titlebar\",ui:\"light\",title:this.$currentTitle||\"\"});var b=(a.splitNavigation===true)?{}:a.splitNavigation;this.$backButtonContainer=this.add(Ext.apply({xtype:\"toolbar\",docked:\"bottom\"},b));this.$backButton=this.$backButtonContainer.add({xtype:\"button\",text:\"Back\",hidden:true,ui:\"back\"});this.$backButton.on({scope:this,tap:this.onBackButtonTap});a={hidden:true,docked:\"top\"}}return Ext.factory(a,Ext.navigation.Bar,this.getNavigationBar())},updateNavigationBar:function(a,b){if(b){this.remove(b,true)}if(a){this.add(a)}",259333,36,"b=this,c=b.getInnerItems();b.getItems();if(!b.initialized){d=c.length-1}return this.callParent([d,a])},doResetActiveItem:function(d){var a=this,c=a.getInnerItems(),b=a.getLayout().getAnimation();if(d>0){if(b&&b.isAnimation){b.setReverse(true)}a.setActiveItem(d-1);a.getNavigationBar().onViewRemove(a,c[d],d)}},doRemov",195872,35,".getAnimation();if(a&&a.isAnimation){a.setReverse(false",479149,32,"ItemAdd:function(b,a){if(b&&b.getDocked()&&b.config.title===true){this.$titleContainer=b}this.doItemLayoutAdd(b,a);var c=this.getInitialConfig().navigationBar;if(!this.isItemsInitializing&&b.isInnerItem()){this.setActiveItem(b);if(c){this.getNavigationBar().onViewAdd(this,b,a)}if(this.$backButtonContainer){this.$backButton.show()}}if(b&&b.isInnerItem()){this.updateTitleContainerTitle((b.getTitle)?b.getTitle():b.config.title",169000,39,"add\",this,b,a)}},updateTitleContainerTitle:function(a){if(this.$titleContainer){this.$titleContainer.setTitle(a)}else{this.$currentTitle=a}},reset:function(){return this.pop(this.getInnerItems().length",455841,26488,"util.Geolocation\",{extend:Ext.util.Geolocation,config:{available:false,autoUpdate:false,timeout:20000,listeners:{locationupdate:function(b,a){b.setAvailable(true)},locationerror:function(f,a,b,e,d,c){f.setAvailable(false)}}}});Ext.define(\"Denkmap.util.Config\",{singleton:true,config:{version:\"0.2.{BUILD_NR}\",leafletMap:{zoom:15,getTileLayerUrl:function(a){if(a){return\"http://{s}.tile.cloudmade.com/{apikey}/{styleId}@2x/256/{z}/{x}/{y}.png\"}else{return\"http://{s}.tile.cloudmade.com/{apikey}/{styleId}/256/{z}/{x}/{y}.png\"}},tileLayerA",491928,179,"apiKey:\"14f1a83f16604a708a4876a956f9dd35\",styleId:997}",316112,45,"return this}});Ext.define(\"Denkmap.util.ObjectType\",{config:{defaultStyle:{radius:11,fillColor:\"#ff7800\",color:\"#000\",weight:1,opacity:1,fillOpacity:0.8},objectTypes:{bruecke:{regex:new RegExp(\"Br\ufffff\ufffffcke\",\"gi\"),style:{fillColor:\"#CC9933\"}},bauernhaus:{regex:new RegExp(\"Bauernh\",\"gi\"),style:{fillColor:\"#996633\"}},schulhaus:{regex:new RegExp(\"(Schul|ETH|Uni|Konservatorium|Institut|Klinik)\",\"gi\"),style:{fillColor:\"#CCFF66\"}},bahnhof:{regex:new RegExp(\"Bahn\",\"gi\"),style:{fillColor:\"#FF0000\"}},schloss:{regex:new RegExp(\"(Schloss|Burg)\",\"gi\"),style:{fillColor:\"#00CCFF\"}},villa:{regex:new RegExp(\"Villa\",\"gi\"),style:{fillColor:\"#006600\"}},kirche:{regex:new RegExp(\"(Kirch|M\ufffff\ufffffnster|Synagoge)\",\"gi\"),style:{fillColor:\"#FF00FF\"}},garten:{regex:new RegExp(\"Garten\",\"gi\"),style:{fillColor:\"#66CC66\"}},amt:{regex:new RegExp(\"(Amt|\ufffff\ufffffmt|Verwaltung|Kanton|Schweiz|Bezirk)\",\"gi\"),style:{fillColor:\"#EAA400\"}},kultur:{regex:new RegExp(\"(Museum|Theater|Tonhalle|Kultur)\",\"gi\"),style:{fillColor:\"#CB59E8\"}},hotel:{regex:new RegExp(\"(Hotel)\",\"gi\"),style:{fillColor:\"#FF0099\"}},haus:{regex:new RegExp(\"(Haus|H\ufffff\ufffffuser|Heim|Altbau|Neubau|Bau|Palais|Herrschaft|Zier)\",\"gi\"),style:{fillColor:\"#669999\"}}}",316112,45,"return this},getStyleForMonument:function(e){var a,b,d={},c=[e.baugruppe,e.objtext];for(b=0;b<c.length;++b){a=c[b];if(!a){continue}return this._getStyleForMonumentType(a)}Ext.apply(d,this.getDefaultStyle());return d},_getStyleForMonumentType:function(b){var a,e,c={},d=this.getObjectTypes();Ext.apply(c,this.getDefaultStyle());for(e in d){a=d[e];if(b.match(a.regex)){Ext.apply(c,a.style);return c}}return c",482305,380,"div class=\"introduction\"><p>This project was started at the <a href=\"http://opendata.ch/projects/open-data-zuerich-hacknights/\">Zurich Hacknights</a> organised by <a href=\"http://www.stadt-zuerich.ch/opendata\">Open Data Z\ufffff\ufffffrich</a>.</p></div><dl class=\"denkmap-definitionlist\"><dt>Version</dt><dd>'+Denkmap.util.Config.getVersion()+'</dd><dt>More Information</dt><dd>Wiki: <a href=\"http://make.opendata.ch/wiki/project:denkmalfuehrer\">make.opendata.ch</a></dd><dd>Report a bug: <a href=\"https://github.com/denkmap/denkmap/issues\">GitHub</a></dd><dt>Team</dt><dd>Pirmin Kalberer</dd><dd>Thomas Husmann</dd><dd>Stefan Oderbolz</dd><dd>Adi Herzog</dd><dd>Priska Haller</dd><dd>Andi Vonlaufen</dd><dd>Beat Estermann</dd><dd>Oliver Berchtold</dd></dl",482683,8883,"map.NavigationView\",{extend:Ext.navigation.View,alias:\"widget.mapnavigationview\",config:{title:\"Map\",iconCls:\"map\",url:\"map\",id:\"mapNavigationView\",items:[{id:\"leafletmap\",xtype:\"leafletmap\",title:\"DenkMap\",useCurrentLocation:true,enableOwnPositionMarker:true,autoMapCenter:false,mapOptions:{zoom:Denkmap.util.Config.getLeafletMap().zoom},tileLayerUrl:Denkmap.util.Config.getLeafletMap().getTileLayerUrl(window.L.Browser.retina),tileLayerOptions:{apikey:Denkmap.util.Config.getLeafletMap().apiKey,styleId:Denkmap.util.Config.getLeafletMap().styleId,attribution:Denkmap.util.Config.getLeafletMap().tileLayerAttribution,detectRetina:true}}],defaultBackButtonText:\"Back\",navigationBar:{items:[{xtype:\"button\",cls:\"mapCenterButton\",iconCls:\"locate\",iconMask:true,align:\"left\"},{cls:\"mapLoadingIcon\",icon:\"./resources/images/transparent_loader.gif\",align:\"right\",hidden:true}]}",491537,151,"xtype:\"mapnavigationview\"",492125,35,"define(\"Denkmap.controller.Map",318802,37,"refs:{mapNavigationView:\"#mapNavigationView\",mapCenterButton:\"#mapNavigationView .button[cls=mapCenterButton]\",mapCmp:\"#leafletmap\"},control:{mapNavigationView:{back:\"_onMapNavigationViewDetailViewBack\"},mapCenterButton:{tap:\"_onMapNavigationViewCenterButtonTap\"}}},init:function(){var a=this;a.getApplication().on({geolocationready:{fn:a._createLeafletMapWrapper,scope:a}});console.log(\"map init finsihed\")},_loadGeoJsonLayer:function(b){var e,c,a,d=this;console.log(\"Load GeoJSON layer: \",b);c=function(g,f){var h=\"<ul>\";if(g.properties.baugruppe){h+=\"<li><b>Baugruppe:</b>&nbsp;\"+g.properties.baugruppe+\"</li>\"}if(g.properties.objtext){h+=\"<li><b>Objekt:</b>&nbsp;\"+g.properties.objtext+\"</li>\"}if(g.properties.baujahr){h+=\"<li><b>Baujahr:</b>&nbsp;\"+g.properties.baujahr+\"</li>\"}h+=\"</ul>\";f.bindPopup(h)};a=Ext.create(\"Denkmap.util.ObjectType\");e=new L.GeoJSON.AJAX(b,{onEachFeature:c,pointToLayer:function(f,h){var g=a.getStyleForMonument(f.properties);return L.circleMarker(h,g)}});e.addTo(this.getMapCmp().getMap());console.log(\"Added to map\")},_createLeafletMapWrapper:function(b){var a=this;console.log(\"Map create\");a._centerMapToCurrentPosition(b);a._loadGeoJsonLayer(\"./resources/remote/denkmal.geojson\")},_onMapNavigationViewCenterButtonTap:function(){this._centerMapToCurrentPosition()},_centerMapToCurrentPosition:function(a){console.log(\"centerMapToCurrentPosition\");this.getMapCmp().setMapCenter(this.getCurrentLocationLatLng())},getCurrentLocationLatLng:function(){var a=this.getMapCmp().getGeo();return L.latLng(a.getLatitude(),a.getLongitude())",492152,87,"controllers:[\"Map",492236,476,"var b,a=this;b=Ext.create(\"Denkmap.view.Main\");Ext.Viewport.add(b);b.hide();Denkmap.geolocation=Ext.create(\"Denkmap.util.Geolocation\");Denkmap.geolocation.updateLocation(function(c){if(c){console.log(\"Updated location\");Ext.defer(a.fireEvent,500,a,[\"geolocationready\",c]);",492712,41,"b.show()}else{console.log(\"Geolocation error\")}}",492801,207]